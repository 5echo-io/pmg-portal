{% extends "portal/base.html" %}
{% load i18n static %}
{% block title %}{% trans "Select Customer" %} | {% trans "PMG Portal" %}{% endblock %}

{% block content %}
  <div class="customer-selection-container">
    <div class="customer-selection-header">
      <h1>{% trans "Select a Customer" %}</h1>
      <p class="muted">{% trans "Choose a customer to access their portal" %}</p>
    </div>

    <div class="customer-selection-grid">
      {% for customer in customers %}
      <div class="customer-card" data-customer-id="{{ customer.id }}" data-customer-select="true">
        {% if customer.logo_url %}
        <div class="customer-card-logo">
          <img src="{{ customer.logo_url }}" alt="{{ customer.name }} logo" onerror="this.style.display='none';" />
        </div>
        {% else %}
        <div class="customer-card-logo customer-card-logo--placeholder">
          <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <circle cx="8.5" cy="8.5" r="1.5"></circle>
            <path d="M21 15l-5-5L5 21"></path>
          </svg>
        </div>
        {% endif %}
        <div class="customer-card-content">
          <h3 class="customer-card-name">{{ customer.name }}</h3>
          {% if customer.org_number %}
          <p class="customer-card-org muted">{% trans "Org. no." %}: {{ customer.org_number }}</p>
          {% endif %}
        </div>
        <div class="customer-card-arrow">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>

  <form method="post" action="" id="customer-switcher-form" style="display: none;">
    {% csrf_token %}
  </form>

  <script>
    // Handle customer selection card clicks
    document.addEventListener('click', function(e) {
      const card = e.target.closest('[data-customer-select="true"]');
      if (card) {
        const customerId = card.getAttribute('data-customer-id');
        if (customerId) {
          selectCustomer(customerId);
        }
      }
    });
  </script>
{% endblock %}
